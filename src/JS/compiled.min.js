"use strict";function logx(e,t){return Math.log(e)/Math.log(t)}function randomBetween(e,t){return Math.random()*(t-e)+e}function random(e,t){return randomBetween(e,t)}function randomInt(e,t){return Math.floor(randomBetween(e,t))}function map(e,t,i,s,a){return s+(a-s)/(i-t)*(e-t)}function threshold(e,t,i){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))-2*i<0}function FrameIDToTime(e){var t=e/60;return t}function distance(e,t,i,s){return Math.pow(Math.pow(e-i,2)+Math.pow(t-s,2),.5)}function randomChoice(e){let t=Math.round(Math.random()*e.length);return e[t]}function randomChoiceNot(e,t){let i=randomChoice(e);for(;i in t;)i=randomChoice(e);return i}function randomBetweenNot(e,t,i){let s=randomBetween(e,t);for(;s in i;)s=randomBetween(e,t);return s}function intBetweenNot(e,t,i){let s=randomInt(e,t);for(;s in i;)s=randomInt(e,t);return s}function coinFlip(e){return Math.random()>e}function clip(e,t,i){return Math.min(Math.max(e,t),i)}function clamp(e,t,i){return Math.min(Math.max(e,t),i)}function strictScale(e,t,i,s,a){return clip(map(clip(e,t,i),t,i,s,a),s,a)}function sum(e){let t=0;for(let i=0;i<e.length;i++)t+=e[i];return t}function minl(e){let t=e[0];for(let i=0;i<=e.length;i++)t=Math.min(t,e[i]);return t}function maxl(e){let t=e[0];for(let i=0;i<=e.length;i++)t=Math.max(t,e[i]);return t}function smoothStep(e,t,i){let s=(e-t)/(i-t);return s*s*(3-2*s)}function sigmoid(e,t){return 1/(1+Math.exp(-t*e))}function smoothSigmoid(e,t){return smoothStep(sigmoid(e,t),0,1)}function AddDebugItem(e,t){if(!DEBUGFLAG)return null;var i=document.createElement("li");return i.id=t,i.innerText=e.toString(),i.classList.add("debugItem"),debugList.appendChild(i),debugList}function SetDebugItem(e,t){if(!DEBUGFLAG)return null;var i=document.getElementById(t);return null==i&&(AddDebugItem(e,t),i=document.getElementById(t)),null==i?null:(i.innerText=t.toString()+": "+e.toString(),i)}function CreateUpgrades(){let e=new Upgrade("",""),t=new Upgrade("gigantisizer","increases projectile size, decreases projectile speed."),i=new Upgrade("shrinker","decreases projectile size, increases projectile speed."),s=new Upgrade("tankifier","increases health, decreases everything else."),a=new Upgrade("slowifier","Makes shots super slow, and damage super high."),r=new Upgrade("quickifier","Makes shots super quick, but have very little damage."),n=[];return t.addEffect(new Effect("ss",-10,1)),t.addEffect(new Effect("sz",10,1)),i.addEffect(new Effect("ss",10,1)),i.addEffect(new Effect("sz",-10,1)),s.addEffect(new Effect("d",-1,1)),s.addEffect(new Effect("h",1,1)),s.addEffect(new Effect("ms",-1,1)),s.addEffect(new Effect("sf",-1,1)),s.addEffect(new Effect("ss",-1,1)),s.addEffect(new Effect("sz",-1,1)),a.addEffect(new Effect("d",20,3)),a.addEffect(new Effect("ss",.5,3)),r.addEffect(new Effect("ss",20,3)),r.addEffect(new Effect("d",.5,3)),t.addRequirement(new Requirement(i,e,"not",!1)),i.addRequirement(new Requirement(t,e,"not",!1)),a.addRequirement(new Requirement(r,e,"not",!1)),r.addRequirement(new Requirement(a,e,"not",!1)),n.push(t),n.push(i),n.push(s),n.push(a),n.push(r),n}function CreateRandomUpgrades(){let e=[],t=["d","h","ms","sf","ss","sz"],i=["and","or","not"];for(let i=0;i<100;i++){let i=new Upgrade("","");for(let e=0;e<randomInt(1,t.length-1);e++){let e=randomChoice(t);for(;e in i.effects;)e=randomChoice(t);let s=randomInt(-50,50),a=randomInt(1,3);3==a&&(s=Math.abs(s)),i.addEffect(new Effect(e,s,a))}e.push(i)}for(let t=0;t<e.length;t++){let s=e[t];s.addRequirement(new Requirement(randomChoiceNot(e,[s]),randomChoiceNot(e,[s]),randomChoice(i),coinFlip(.5)))}return e}function SetProgressBar(e){XPBar.value=e/10}function IncreaseProgressBar(e){XPBar.value=XPBar.value+e/10}function AnimateProgressBar(e){XPBar.style.backgroundColor=`linear-gradient(90deg, #5ba2ac ${e%100}%, #28257f ${(e+50)%100}%, #1a641a ${(e+100)%100}%);`}function ResetProgressBar(){XPBar.value=0,XPBar.max=1,player.level=0,player.cachedLevels=0}function CheckForLevelUp(){return XPBar.value>=XPBar.max&&(player.level+=1,player.cachedLevels+=1,XPBar.value=0,XPBar.max=player.level,!0)}function CreateHealth(e,t){let i=new HealthBar(e,t);return i}function animate(){animationID=requestAnimationFrame(animate),Paused||(CheckForLevelUp(),SetDebugItem(player.level,"playerLevel"),SetDebugItem(player.cachedLevels,"playerCashedLevels"),(animationID%Math.floor(EnemySpawnTime)==0&&enemies.length<MaxEnemies||enemies.length<MaxEnemies-5)&&(SpawnEnemy(),EnemySpawnTime-=.125),SetDebugItem(EnemySpawnTime,"SpawnTime"),player.update(),AnimateProgressBar(animationID),c.fillStyle="rgba(0,0,0,0.1)",c.fillRect(0,0,w,h),UseParticles&&particles.forEach((e,t)=>{e.alpha<=0?particles.splice(t,1):e.update()}),projectiles.forEach((e,t)=>{e.update(),(e.x+e.radius<0||e.y+e.radius<0||e.x-e.radius>w||e.y-e.radius>h)&&(projectiles.splice(t,1),SFXMuted||MissSound.play())}),enemies.forEach((e,t)=>{e.update();const i=distance(player.x,player.y,e.x,e.y);i-e.radius-player.radius<0&&(player.willDie?(player.Health.removeHealth(),gameOver(animationID)):(player.Health.removeHealth(),SFXMuted||HealthLooseSound.play(),enemies.splice(t,1),SetDebugItem(player.Health.Health,"playerHealth"),EnemySpawnTime=Math.max(50,EnemySpawnTime+10))),projectiles.forEach((i,s)=>{const a=distance(i.x,i.y,e.x,e.y);if(a-e.radius-i.radius<0){for(let t=0;t<Math.round(2*e.radius*ParticleMultiplier*Math.random());t++)particles.push(new Particle(i.x,i.y,4*Math.random()+1,e.color,{x:(Math.random()+i.velocity.x/(2*player.ShotSpeed*ProjectileSpeedMultiplier))*Math.random()*ParticleSpeed,y:(Math.random()+i.velocity.y/(2*player.ShotSpeed*ProjectileSpeedMultiplier))*Math.random()*ParticleSpeed}));e.ShouldDie(i.damage)?(SFXMuted||HitAndKillSound.play(),AddScore(250),setTimeout(()=>{enemies.splice(t,1),projectiles.splice(s,1)},2)):(SFXMuted||HitNoKillSound.play(),AddScore(100),e.radius-=i.damage,setTimeout(()=>{projectiles.splice(s,1)},2))}a-e.radius-i.radius<20&&(SFXMuted||MissSound.play())})}),lastScore%freq>score%freq&&0!=score&&(player.Health.addHealth(1),SFXMuted||HealthGetSound.play()),lastScore=score)}function init(){EnemySpawnTime=DefaultEnemySpawnTime,Paused=!1,player=new Player(cw,ch,PlayerRadius,PlayerColor),projectiles=[],enemies=[],particles=[],score=0,scoreEL.innerHTML=score.toString(10),BigScoreEL.innerHTML=score.toString(10),XPBar.style.display="initial",ResetProgressBar(),GameStarted=!0}function PageLoad(){HighScoreLabel.style.display="none",ModalEL.style.display="flex",XPBar.style.display="none",OptionsSFXSlider.value="0",OptionsMusicSlider.value="0",CloseOptionsMenu(),HighScoreList.style.display="none",UnpauseGame(),MusicPlayer.pause(),AddDebugItem(0,"playerLevel"),AddDebugItem(0,"playerCashedLevels"),AddDebugItem(!1,"CantSpawn"),AddDebugItem(5,"playerHealth"),AddDebugItem(EnemySpawnTime,"SpawnTime"),AddDebugItem(EnemySpawnBias,"Bias"),player.Health.draw(),Paused=!0,OptionsOpen=!1}function UpdateSFXSlider(){ShootSound.muted=SFXMuted,HitNoKillSound.muted=SFXMuted,HitAndKillSound.muted=SFXMuted,HealthGetSound.muted=SFXMuted,HealthLooseSound.muted=SFXMuted,MissSound.muted=SFXMuted,SFXMuted||(ShootSound.volume=parseFloat(OptionsSFXSlider.value),HitNoKillSound.volume=parseFloat(OptionsSFXSlider.value),HitAndKillSound.volume=parseFloat(OptionsSFXSlider.value),HealthGetSound.volume=parseFloat(OptionsSFXSlider.value),HealthLooseSound.volume=parseFloat(OptionsSFXSlider.value),MissSound.volume=parseFloat(OptionsSFXSlider.value))}function PlayMusic(){MusicMuted||MusicPlayer.shuffle()}function SpawnEnemy(){function e(){let e,t;const i=26*Math.random()*EnemyHealthMultiplier+4;coinFlip(EnemySpawnBias)?(e=Math.random()<.5?0-i:w+i,t=Math.random()*h):(e=Math.random()*w,t=Math.random()<.5?0-i:h+i);const s=`hsl(${360*Math.random()},50%,50%)`,a=Math.atan2(ch-t,cw-e),r={x:Math.cos(a)*EnemySpeedMultiplier,y:Math.sin(a)*EnemySpeedMultiplier};return new Enemy(e,t,i,s,r)}enemies.push(e())}function AddScore(e){score+=e,scoreEL.innerHTML=score.toString(10),BigScoreEL.innerHTML=score.toString(10)}function gameOver(e){cancelAnimationFrame(e),HS=!!Scores.scores.every(e=>e<score),Scores.addScore(score),GameStarted=!1,ModalEL.setAttribute("style","display:flex;"),HighScoreList.innerHTML=Scores.Html,console.log(Scores),HighScoreLabel.style.display=HS?"block":"none",BigScoreELLabel.style.display="block",BigScoreEL.style.display="block",BigScoreEL.innerText=score.toString(),BigScoreEL.classList.add("animate-bounce")}function PauseGame(){PauseModal.style.display="block",PauseModalScore.innerHTML=score.toString(10),Paused=!0}function UnpauseGame(){PauseModal.style.display="none",Paused=!1}function OpenOptionsMenu(){OptionsParticleSpan.style.display="block",OptionsMenu.style.display="block",OptionsSFXSlider.style.display="block",OptionsBackButton.style.display="block",OptionsParticleSwitch.style.display="block",OptionsOpen=!0}function CloseOptionsMenu(){OptionsParticleSpan.style.display="none",OptionsMenu.style.display="none",OptionsSFXSlider.style.display="none",OptionsBackButton.style.display="none",OptionsParticleSwitch.style.display="none",OptionsOpen=!1}function spawnProjectile(e,t){if(1==GameStarted&&0==Paused){const i=Math.atan2(t-ch,e-cw),s={x:Math.cos(i)*player.ShotSpeed*ProjectileSpeedMultiplier,y:Math.sin(i)*player.ShotSpeed*ProjectileSpeedMultiplier},a=5,r=player.Damage;projectiles.push(new Projectile(cw,ch,a,ProjectileColor,s,r)),SFXMuted||ShootSound.play()}}const canvas=document.querySelector("canvas"),c=canvas.getContext("2d");canvas.width=innerWidth,canvas.height=innerHeight,c.shadowBlur=20,c.shadowColor="black";const scoreEL=document.querySelector("#scoreEL"),MoneyEL=document.querySelector("#moneyEL"),ShopMoney=document.querySelector("#ShopMoney"),startGameButton=document.querySelector("#StartGameWrapper"),HighScoreLabel=document.querySelector("#highScoreTextModal"),ModalEL=document.querySelector("#ModalEL"),TitleEL=document.querySelector("#titleElement"),BigScoreEL=document.querySelector("#BigScoreEL"),BigScoreELLabel=document.querySelector("#PointsLabelEL"),NameDiv=document.querySelector("#NameInputDiv"),HighScoreList=document.querySelector("#HighScore"),ShootSound=new Audio("Audio/sound/Shoot.wav"),HitNoKillSound=new Audio("Audio/sound/HitNoKill.wav"),HitAndKillSound=new Audio("Audio/sound/HitAndKill.wav"),HealthGetSound=new Audio("Audio/sound/HealthGet.wav"),HealthLooseSound=new Audio("Audio/sound/HealthLose.wav"),MissSound=new Audio("Audio/sound/Miss.wav"),Music1=new Audio("Audio/music/Music1.mp3"),Music2=new Audio("Audio/music/Music2.mp3"),Music3=new Audio("Audio/music/Music3.mp3"),Music4=new Audio("Audio/music/Music4.mp3"),Music5=new Audio("Audio/music/Music5.mp3"),PauseModal=document.querySelector("#PauseModal"),PauseModalScore=document.querySelector("#PauseModalScore"),PauseModalScoreLabel=document.querySelector("#PauseModalScoreLabel"),PauseModalOptionsButton=document.querySelector("#PauseModalOptionsButton"),PauseModalPlayButton=document.querySelector("#PauseModalPlayButton"),OptionsMenu=document.querySelector("#OptionsModal"),OptionsSFXSlider=document.querySelector("#SFXSlider"),OptionsMusicSlider=document.querySelector("#MusicSlider"),OptionsParticleSwitch=document.querySelector("#ParticleOptionsSwitch"),OptionsBackButton=document.querySelector("#OptionsBackButton"),OptionsParticleSpan=document.querySelector("#ParticleOptionsSpan"),XPBar=document.querySelector("#XPBar"),XPBarLabel=document.querySelector("#XPbarLabel"),debugDiv=document.querySelector("#debugDiv"),debugList=document.querySelector("#debugList"),w=canvas.width,h=canvas.height,cw=w/2,ch=h/2,DEBUGFLAG=!0;let SFXMuted=!0,OptionsOpen=!1,browserType=navigator;console.log(browserType),AddDebugItem(0,"playerHealth"),AddDebugItem(innerWidth,"windowWidth"),AddDebugItem(innerHeight,"windowHeight"),AddDebugItem(innerHeight*innerWidth,"WindowArea");class Upgrade{constructor(e,t){this.color="#00000",this.name=e,this.Description=t,this.effects=[],this.requirements=[]}addEffect(e){this.effects.push(e)}addRequirement(e){this.requirements.push(e)}}class UpgradeList{constructor(e){this.upgrades=e}addUpgrade(e){return this.upgrades.push(e),this.upgrades}removeUpgrade(e){return this.upgrades.splice(this.upgrades.indexOf(e),1),this.upgrades}}class AllUpgradesList extends UpgradeList{constructor(e){super(e),this.availableUpgrades=e}get availibility(){return this.upgrades.filter((e,t,i)=>{let s=[];return e.requirements.forEach(e=>{s.push(e.IsRequirementTrue(i))}),s.every(e=>e)})}}class Effect{constructor(e,t,i){this.type=e,this.value=t,this.valuetype=i}apply(e){switch(this.type){case"d":1==this.valuetype?e.Damage+=this.value:2==this.valuetype?e.Damage*=this.value:3==this.valuetype&&(e.Damage=this.value);break;case"ss":1==this.valuetype?e.ShotSpeed+=this.value:2==this.valuetype?e.ShotSpeed*=this.value:3==this.valuetype&&(e.ShotSpeed=this.value);break;case"sf":1==this.valuetype?e.ShotsFired+=this.value:2==this.valuetype?e.ShotsFired*=this.value:3==this.valuetype&&(e.ShotsFired=this.value);break;case"ms":1==this.valuetype?e.MultiShot+=this.value:2==this.valuetype?e.MultiShot*=this.value:3==this.valuetype&&(e.MultiShot=this.value);break;case"sz":1==this.valuetype?e.ShotSize+=this.value:2==this.valuetype?e.ShotSize*=this.value:3==this.valuetype&&(e.ShotSize=this.value);break;case"h":1==this.valuetype?e.Health.Health+=this.value:2==this.valuetype?e.Health.Health*=this.value:3==this.valuetype&&(e.Health.Health=this.value)}}}class Requirement{constructor(e,t,i,s){this.requirement1=e,this.requirement2=t,this.operation=i,this.not=s}IsRequirementTrue(e){if("or"==this.operation){if(!this.not)return-1!=e.indexOf(this.requirement1)||-1!=e.indexOf(this.requirement2);if(this.not)return!(-1!=e.indexOf(this.requirement1)||-1!=e.indexOf(this.requirement2))}else{if("and"!=this.operation)return"not"==this.operation&&-1==e.indexOf(this.requirement1);if(!this.not)return-1!=e.indexOf(this.requirement1)&&-1!=e.indexOf(this.requirement2);if(this.not)return!(-1!=e.indexOf(this.requirement1)&&-1!=e.indexOf(this.requirement2))}return!1}}class Halo{constructor(e,t,i,s,a,r){this.starts=e,this.ends=t,this.colors=i,this.isValid=this.checkForValidity(),this.x=s.x,this.y=s.y,this.radius=s.radius,this.moving=a,this.speed=r}checkForValidity(){if(this.starts.length!=this.ends.length)throw new Error("Starts And Ends length must be the same");if(this.starts.length!=this.colors.length)throw new Error("Starts And Colors length must be the same");if(this.colors.length!=this.ends.length)throw new Error("Colors And Ends length must be the same");if(this.starts.some(e=>e>TWOPI||e<0))throw new Error("Starts must be in the range 0-2*PI");if(this.ends.some(e=>e>TWOPI||e<0))throw new Error("Ends must be in the range 0-2*PI");return!0}updateVals(e){this.x=e.x,this.y=e.y,this.radius=e.radius}update(e,t){this.updateVals(t),this.step(e),this.fix()}step(e){switch(this.moving){case!1:break;case 1:for(let t=0;t<this.starts.length;t++)this.starts[t]+=.01*e,this.ends[t]+=.01*e;break;case 2:for(let t=0;t<this.starts.length;t++)this.speed=random(-.5,2),this.starts[t]+=.01*e*this.speed,this.ends[t]+=.01*e*this.speed}}fix(){this.ends=this.ends.map(e=>clip(e,0,TWOPI)),this.starts=this.starts.map(e=>clip(e,0,TWOPI)),this.ends[this.ends.indexOf(maxl(this.ends))]=TWOPI,this.starts[this.starts.indexOf(minl(this.starts))]=0}draw(e){let t=c;for(let i=0;i<this.starts.length;i++)t.fillStyle=this.colors[i],t.beginPath(),t.arc(this.x,this.y,this.radius+map(i,0,this.starts.length,0,2*e),this.starts[i],this.ends[i]),t.closePath(),t.fill(),t.stroke()}}class HealthBar{constructor(e,t){this.health=e,this.MaxHealth=t}get Health(){return this.health}get maxHealth(){return this.MaxHealth}set Health(e){this.health=e,this.draw()}set maxHealth(e){this.MaxHealth=e,this.draw()}addHealth(e){return this.health<this.maxHealth&&(this.health+=e),this.draw(),this.health}removeHealth(e=1){return this.health-=e,this.draw(),this.health}get willDie(){return this.health-1<=0}get dead(){return 0==this.health}draw(){let e=document.getElementById("healthBar");if(null==e)throw new Error("Health bar element not found");let t=e.children.length,i=this.MaxHealth;for(let i=0;i<t;i++)try{e.removeChild(e.children[0])}catch(e){e instanceof TypeError?console.log("Health bar span not found"):e instanceof RangeError?console.log("Health bar span not found"):e instanceof ReferenceError&&console.log("Health bar span not found"),console.log("Health bar span not found")}for(let t=0;t<i;t++){let t=document.createElement("span");t.classList.add("material-icons"),t.classList.add("healthBarSpan"),e.appendChild(t)}let s=e.children;for(let e=0;e<i;e++){var a=s.item(e);a.innerText="favorite",e<this.health?a.style.color="red":a.style.color="grey"}}}class Player{constructor(e,t,i,s){this.x=e,this.y=t,this.radius=i,this.color=s,this.cachedLevels=0,this.level=0,this.Damage=10,this.ShotSpeed=5,this.ShotsFired=1,this.MultiShot=1,this.AutoFire=!1,this.AutoRotate=!1,this.ShotSize=5,this.Health=CreateHealth(5,5),this.Health.draw(),SetDebugItem(this.Health.Health,"playerHealth")}update(){SetDebugItem(this.Health.Health,"playerHealth"),this.draw(),this.drawHealth()}drawHealth(){this.Health.draw()}draw(){c.beginPath(),c.arc(this.x,this.y,this.radius,0,TWOPI,!1),c.fillStyle=this.color,c.fill()}get willDie(){return this.Health.willDie}}class Projectile{constructor(e,t,i,s,a,r){this.x=e,this.y=t,this.radius=i,this.color=s,this.velocity=a,this.damage=r}draw(){DEBUGFLAG&&(c.strokeStyle="rgb(255,128,0)",c.rect(this.x-2*this.radius,this.y-2*this.radius,this.x+2*this.radius,this.y+2*this.radius)),c.beginPath(),c.arc(this.x,this.y,this.radius,0,TWOPI,!1),c.fillStyle=this.color,c.fill()}update(){this.draw(),this.x+=this.velocity.x,this.y+=this.velocity.y}}class Enemy{constructor(e,t,i,s,a){this.x=e,this.y=t,this.radius=i,this.color=s,this.velocity=a,this.startingRadius=this.radius,this.minHealth=5,this.timeCreated=Date(),this.burning=!1,this.haloObject=new Halo([0,Math.PI,TWOPI],[Math.PI,TWOPI,0],["#ff0000","ff8800","ffff00"],this,2,2)}draw(){DEBUGFLAG&&(c.strokeStyle="rgb(0,255,0)",c.rect(this.x-2*this.radius,this.y-2*this.radius,this.x+2*this.radius,this.y+2*this.radius)),this.burning&&this.haloObject.draw(5),c.beginPath(),c.arc(this.x,this.y,this.radius,0,TWOPI,!1),c.fillStyle=this.color,c.fill()}update(){this.x+=this.velocity.x,this.y+=this.velocity.y,this.haloObject.update(5,this),this.draw()}ShouldDie(e){return this.radius-e<this.minHealth}damage(e){return this.radius-=e,this.ShouldDie(e)}}class Particle{constructor(e,t,i,s,a){this.x=e,this.y=t,this.radius=i,this.color=s,this.velocity=a,this.alpha=1}draw(){DEBUGFLAG&&(c.strokeStyle="rgb(0,0,255)",c.rect(this.x-2*this.radius,this.y-2*this.radius,this.x+2*this.radius,this.y+2*this.radius)),c.save(),c.globalAlpha=this.alpha,c.beginPath(),c.arc(this.x,this.y,this.radius,0,TWOPI,!1),c.fillStyle=this.color,c.fill(),c.restore()}update(){this.draw(),this.velocity.x*=ParticleFriction,this.velocity.y*=ParticleFriction,this.x+=this.velocity.x,this.y+=this.velocity.y,this.alpha-=randomBetween(.001,.025)*ParticleFadeSpeedMultiplier}}class HighScore{constructor(){this.scores=[]}addScore(e){0!=e&&this.scores.push(e),this.sort()}sort(){this.scores.sort((e,t)=>e-t),this.scores.reverse()}isHighScore(e){return this.scores.every(t=>t<e)}get Html(){let e=document.createElement("ol");this.sort();for(let i=0;i<Math.min(this.scores.length,10);i++){const s=this.scores[i];var t=document.createElement("li");switch(i){case 0:t.style.color="#ffd700",t.appendChild(document.createTextNode(s.toString(10)));break;case 1:t.style.color="#c0c0c0",t.appendChild(document.createTextNode(s.toString(10)));break;case 2:t.style.color="#CD7F32",t.appendChild(document.createTextNode(s.toString(10)));break;default:t.style.color="#FFFFFF",t.appendChild(document.createTextNode(s.toString(10)))}e.appendChild(t)}return e.innerHTML}}class Music{constructor(e){this.music=e,this.current=0,this.volume=1,this.muted=!1,this.Continue=!0}get Current(){return this.music[this.current]}get Volume(){return this.volume}set Volume(e){this.volume=e,this.music.forEach(e=>{e.volume=this.volume}),this.muted=0==this.volume}get Muted(){return this.muted}set Muted(e){this.muted=e,this.music.forEach(e=>{e.muted=this.muted})}play(){this.stopAll(),this.music[this.current].play()}pause(){this.music[this.current].pause()}next(){this.current=(this.current+1)%this.music.length,this.music[this.current].play()}previous(){this.current=(this.current-1+this.music.length)%this.music.length,this.music[this.current].play()}toggle(){this.music[this.current].paused?this.music[this.current].play():this.music[this.current].pause()}shuffle(){this.current=randomInt(0,this.music.length-1),this.music[this.current].play()}set continue(e){this.Continue=e,this.Continue?this.music[this.current].onended=(()=>{this.next()}):this.music[this.current].onended=(()=>{this.music[this.current].pause()})}stop(){this.music[this.current].pause(),this.music[this.current].currentTime=0}stopAll(){this.music.forEach(e=>{e.pause(),e.currentTime=0})}get playing(){let e=0;return this.music.forEach(t=>{t.paused||e++}),e}}const EnemySpawnTimeDecrement=1,EnemySpawnBias=innerHeight/innerWidth,EnemyHealthMultiplier=1,EnemySpeedMultiplier=1,ProjectileSpeedMultiplier=1,ProjectileColor="white",PlayerColor="white",PlayerRadius=10,BackgroundColor="0,0,0",ParticleFriction=.99,ParticleMultiplier=2,ParticleSpeed=5,ParticleFadeSpeedMultiplier=1,MaxEnemies=10,TWOPI=2*Math.PI;let lastInterval,animationID,player=new Player(cw,ch,PlayerRadius,PlayerColor),projectiles=[],enemies=[],particles=[],GameStarted=!1,UseParticles=!0,Paused=!1,ShopOpen=!1,MusicMuted=!0,EnemySpawnTime=50,score=0,DefaultEnemySpawnTime=50,enemiesToRemove=[],Scores=new HighScore,lastScore=0,freq=25e3,HS=!0,MusicPlayer=new Music([Music1]);MusicPlayer.play(),addEventListener("click",e=>spawnProjectile(e.clientX,e.clientY)),addEventListener("load",()=>{PageLoad()}),startGameButton.addEventListener("click",()=>{ModalEL.style.display="none",init(),animate()}),PauseModalPlayButton.addEventListener("click",()=>{UnpauseGame()}),addEventListener("keypress",e=>{"q"==e.key&&GameStarted&&(Paused?(CloseOptionsMenu(),OptionsOpen=!1,UnpauseGame()):PauseGame())}),PauseModalOptionsButton.addEventListener("click",()=>{OpenOptionsMenu(),OptionsOpen=!0}),OptionsBackButton.addEventListener("click",()=>{CloseOptionsMenu(),OptionsOpen=!1}),OptionsParticleSwitch.addEventListener("change",()=>{UseParticles=!UseParticles}),OptionsSFXSlider.addEventListener("change",()=>{SFXMuted="0"==OptionsSFXSlider.value,UpdateSFXSlider()}),OptionsMusicSlider.addEventListener("change",()=>{MusicMuted="0"==OptionsMusicSlider.value,MusicPlayer.Volume=parseFloat(OptionsMusicSlider.value),PlayMusic(),MusicPlayer.shuffle(),MusicPlayer.continue=!0});